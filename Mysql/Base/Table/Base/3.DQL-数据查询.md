## DQL - 数据查询
```
DQL（Data Query Language）数据查询语言
专门指查询（也就是 SELECT）。
常见内容：SELECT / FROM / WHERE / GROUP BY / HAVING / ORDER BY / LIMIT、JOIN、子查询等。
```

### 执行顺序
```
FROM → WHERE → GROUP BY → HAVING → SELECT → ORDER BY → LIMIT
FROM：确定数据来源、把表组合起来。从哪些表取数据；如何 JOIN（内连/外连）
WHERE：分组前过滤“行”。逐行判断条件，条件不满足的行直接丢掉；不能直接写聚合条件（因为还没分组）
GROUP BY：把行分组，如按 area_name 分组：同一个国家的行归为一组。分组之后，结果的基本单位从“行”变成“组”；这一步把“行数据”变成“组数据”。
HAVING：分组后过滤“组”。可以写聚合条件，比如 HAVING COUNT(*) >= 2；先算每组聚合结果，再决定保留哪些组
SELECT：生成要展示的列，定义输出列长什么样“投影/生成列”
ORDER BY：对最终结果排序，例如按 cnt DESC 或按 name ASC
LIMIT：截取前 N 行（MySQL/PostgreSQL）LIMIT 10：取前 10 行，LIMIT 20, 10：跳过 20 行再取 10 行
```

### 1. 基本查询
```
# 查询字段
select 字段1,字段2... from 表名;
select * from 表名;

# 设置别名,可以设置查询结果的字段名
select 字段1[as 别名1],字段2[as 别名2]... from 表名;

# distinct 结果去重去重
select distinct 字段列表 from 表名;
例如：
# 查询不是日本电影的，其他国家电影数量大于1的国家有哪些
select a.area_name, count(distinct ma.movie_id) as '电影数量'
from movie_area ma
         join area a on ma.area_id = a.area_id
where not a.area_name = '日本'
group by a.area_name
having count(distinct ma.movie_id)>1;
```

### 2. 条件查询(where 过滤)
```
select 字段列表 from 表名 where 条件列表;

# 范围
between ... and ...		[最小值，最大值]
in(...)				    存在列表中
like 占位符			    模糊匹配(_匹配单个字符,%匹配多个字符)
is null				    判断为空
is not null 			判断存在

# 关联
and		&&			与
or		||			或
not		!			非
```

### 3. 分组查询(group by 分组, having 分组后过滤)
```
select 字段列表 from 表名 [where 条件] group by 分组字段名 [having 分组后过滤条件];
group by是对数据进行分组，将其分成一个个数据组
where与having的区别：
执行时机不同：where分组前过滤，不满足where条件，不参与分组；having是在分组后对数据组进行过滤
判断条件不同：where不能对聚合函数进行判断，而having可以
```

### 4. 排序查询(order by 排序)
```
select 字段列表 from 表名 order by 字段1 排序方式1,字段2 排序方式2;
asc，升序(默认)；desc，降序
例如：
select name, score from movie order by score desc;
从高往低的评分查看电影
```

### 5. 分页查询(limit 分页)
```
select 字段列表 from 表名 limit 起始索引,查询数量;
起始索引 = (查询页码-1)*每页显示的记录数
例如：
SELECT movie_id, name FROM movie ORDER BY movie_id LIMIT 1, 2;
跳过前1行，显示其后面的2行数据
```
